{"version":3,"file":"editor.bundle.js","sources":["../src/editor.js"],"sourcesContent":["import {ObjectGUI} from \"savmaxru.objectgui\";\nimport {Tag} from 'main.core';\nimport './css/style.css'\nimport {ComponentEditor} from \"savmaxru.componenteditor\";\nimport {ComponentsGallery} from \"savmaxru.componentsgallery\";\nimport {GUIComponents} from \"savmaxru.guicomponents\";\nimport {IDManager} from 'savmaxru.idmanager';\n\nexport class Editor extends ObjectGUI\n{\n\tIDManager = new IDManager(\"editform\");\n\n\tconstructor(ID)\n\t{\n\t\tsuper();\n\t\tthis.setRootNode(\n\t\t\tTag.render`\n\t\t\t${this.addNode(\"editor-wrapper\")}`\n\t\t);\n\n\t\tthis.includeInNode(\"editor-wrapper\", Tag.render`\n\t\t<div class=\"navigation-bar\">\n\t\t\t<div class=\"a-wrapper\">\n\t\t\t\t<a href=\"/forms/result/${ID}\" target=\"_blank\">${BX.message(\"RESULT\")}</a>\n\t\t\t\t<a href=\"/forms/view/${ID}\" target=\"_blank\">${BX.message(\"FORM_PAGE\")}</a>\n\t\t\t</div><br>\n\t\t</div>\n\t\t`);\n\n\t\tlet componentEditor = new ComponentEditor(this.getNode(\"editor-wrapper\"));\n\n\t\tlet argumentID = ID;\n\t\tif(argumentID === '0')\n\t\t{\n\t\t\targumentID = \"NEW_FORM\";\n\t\t}\n\n\t\tlet configGallery = {\n\t\t\t\"galleryClassCSS\": \"editor-gallery\",\n\t\t\t\"componentEditor\": componentEditor,\n\t\t\t\"argumentsForResult\": {\n\t\t\t\t'ID': argumentID,\n\t\t\t\ttitle: 'title new form ',\n\t\t\t},\n\t\t};\n\n\t\tlet gallery = new ComponentsGallery(configGallery, this, this.IDManager);\n\t\tcomponentEditor.setGallery(gallery);\n\t\tgallery.enableEditMode();\n\n\t\tgallery.createComponentWithOption(\"Button\");\n\n\t\tthis.includeInNode(\"editor-wrapper\", gallery.getHTMLObject());\n\n\t\tlet addComponentButton = GUIComponents.attach(\"Button\");\n\t\taddComponentButton.setStyle('plus-button');\n\t\tthis.includeInNode(\"editor-wrapper\", addComponentButton.getHTMLObject());\n\n\t\tlet saveButton = GUIComponents.attach(\"Button\");\n\t\tsaveButton.build(\n\t\t\t{\n\t\t\t\t'options':[\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: BX.message(\"SAVE_FORM\"),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\tthis.includeInNode(\"editor-wrapper\", saveButton.getHTMLObject());\n\n\t\tsaveButton.onDown(function(){\n\t\t\tlet changes = gallery.getChanges();\n\n\t\t\tchanges = {\n\t\t\t\t\tID: 'NEW_FORM',\n\t\t\t\t\ttitle: 'tisdsds ',\n\t\t\t\t\tvisible: true,\n\t\t\t\t\tquestions: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tID: 121212,\n\t\t\t\t\t\t\tindex: 1,\n\t\t\t\t\t\t\ttype: \"CheckboxList\",\n\t\t\t\t\t\t\tdescription: \"Текст вопроса\",\n\t\t\t\t\t\t\tcomment: \"Пояснительный комметарий\",\n\t\t\t\t\t\t\trequired: true,\n\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tindex: 1,\n\t\t\t\t\t\t\t\t\tID: 121212,\n\t\t\t\t\t\t\t\t\tvalue: \"Russia\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tindex: 2,\n\t\t\t\t\t\t\t\t\tID: 121212,\n\t\t\t\t\t\t\t\t\tvalue: \"Russiaaaa\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\n\t\t\t\t\t\t},{\n\t\t\t\t\t\t\tID: 121212,\n\t\t\t\t\t\t\tindex: 2,\n\t\t\t\t\t\t\ttype: \"Heading\",\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tindex: 1,\n\t\t\t\t\t\t\t\t\tvalue: 'Такой вот опрос',\n\t\t\t\t\t\t\t\t\tID: 121212,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},{\n\t\t\t\t\t\t\tID: 121212,\n\t\t\t\t\t\t\tindex: 3,\n\t\t\t\t\t\t\ttype: \"Button\",\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tID: 121212,\n\t\t\t\t\t\t\t\t\tindex: 1,\n\t\t\t\t\t\t\t\t\tvalue: 'Отправить',\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},{\n\t\t\t\t\t\t\tID: 121212,\n\t\t\t\t\t\t\tindex: 4,\n\t\t\t\t\t\t\ttype: \"MultiLineTextBox\",\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvalue: '',\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t};\n\n\t\t\tBX.ajax.runComponentAction('savmaxru:forms.editor', 'saveInterviewStructure', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tresult: changes,\n\t\t\t\t}\n\t\t\t});\n\t\t\tconsole.log(changes);\n\t\t});\n\n\t\taddComponentButton.onDown(function(){\n\t\t\tcomponentEditor.runCreator();\n\t\t});\n\n\t}\n}"],"names":["Editor","ID","IDManager","setRootNode","Tag","render","addNode","includeInNode","BX","message","componentEditor","ComponentEditor","getNode","argumentID","configGallery","title","gallery","ComponentsGallery","setGallery","enableEditMode","createComponentWithOption","getHTMLObject","addComponentButton","GUIComponents","attach","setStyle","saveButton","build","value","onDown","changes","getChanges","visible","questions","index","type","description","comment","required","options","ajax","runComponentAction","mode","data","result","console","log","runCreator","ObjectGUI"],"mappings":"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"}